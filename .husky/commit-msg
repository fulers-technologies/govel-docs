#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ“ Validating commit message..."

# Run commitlint to validate the commit message
npx --no-install commitlint --edit "$1"

if [ $? -ne 0 ]; then
  echo ""
  echo "âŒ Commit message validation failed!"
  echo ""
  echo "ğŸ“‹ Commit message format should follow conventional commits with emojis:"
  echo "   <emoji> <type>[optional scope]: <description>"
  echo ""
  echo "ğŸ·ï¸  Valid types with emojis:"
  echo "   âœ¨ feat:     A new feature"
  echo "   ğŸ› fix:      A bug fix"
  echo "   ğŸ“š docs:     Documentation only changes"
  echo "   ğŸ’„ style:    Changes that do not affect the meaning of the code"
  echo "   â™»ï¸ refactor: A code change that neither fixes a bug nor adds a feature"
  echo "   âš¡ï¸ perf:     A code change that improves performance"
  echo "   âœ… test:     Adding missing tests or correcting existing tests"
  echo "   ğŸ‘· build:    Changes that affect the build system or external dependencies"
  echo "   ğŸ’š ci:       Changes to CI configuration files and scripts"
  echo "   ğŸ”§ chore:    Other changes that don't modify src or test files"
  echo "   âª revert:   Reverts a previous commit"
  echo "   ğŸš§ wip:      Work in progress"
  echo "   â¬†ï¸ deps:     Dependency updates"
  echo "   ğŸ”’ security: Security fixes"
  echo "   ğŸŒ i18n:     Internationalization and localization"
  echo "   âš™ï¸ config:   Configuration changes"
  echo "   ğŸš€ release:  Release commits"
  echo ""
  echo "ğŸ“ Examples with emojis:"
  echo "   âœ¨ feat(auth): add user authentication"
  echo "   ğŸ› fix(http): resolve connection timeout issue"
  echo "   ğŸ“š docs: update README with installation instructions"
  echo "   ğŸ’„ style: format code according to style guide"
  echo "   â¬†ï¸ deps: upgrade Go to version 1.21"
  echo ""
  echo "ğŸ’¡ Use 'pnpm run commit' for an interactive commit message builder with emoji support"
  echo ""
  exit 1
fi

echo "âœ… Commit message is valid! ğŸ‰"

